2.【火星文计算】
【火星文计算】已知火星人使用的运算符为#、$，其与地球人的等价公式如下：

x#y = 2x+3y+4

x$y = 3*x+y+2

其中x、y是无符号整数
地球人公式按C语言规则计算
火星人公式中，$的优先级高于#，相同的运算符，按从左到右的顺序计算 现有一段火星人的字符串报文，请你来翻译并计算结果。
输入描述：

火星人字符串表达式（结尾不带回车换行）
**输入的字符串说明： **

字符串为仅由无符号整数和操作符（#、$）

组成的计算表达式。例如：123#45#6778

用例保证字符串中，操作数与操作符之间没有任何分隔符。
用例保证操作数取值范围为32位无符号整数。
保证输入以及计算结果不会出现整型溢出。
保证输入的字符串为合法的求值报文，例如：123#45#6778
保证不会出现非法的求值报文，例如类似这样字符串：
#4$5 //缺少操作数
4$5# //缺少操作数
4#$5 //缺少操作数
4 $5 //有空格
3+4-5*6/7 //有其它操作符
12345678987654321$54321 //32位整数计算溢出
输出描述：

根据输入的火星人字符串输出计算结果（结尾不带回车换行）

示例

输入：

7#6$5#12
输出：

226
说明：

```
7#6$5#12

=7#(3*6+5+2)#12
=7#25#12
=(2*7+3*25+4)#12
=93#12
=2*93+3*12+4
=226
```

思路1：

①对其中的"#$"位置进行计算

②利用第一步定位的信息分别对字符串分隔进行截取入栈stack

③对"$"处理，定义另一个辅助栈r_stack，第二步的栈stack进行弹出，判断是否是"$"

若是，将r_stack出栈，作为参数x,stack继续弹出，作为参数y, 利用`3*{x}+{y}+2`入栈stack

若不是，则入辅助栈r_stack

④对#进行处理，同样栈stack出栈作为参数x，继续出栈是符号#，再出栈是y

利用`2*{x}+3*{y}+4`计算后作为x，继续循环，最近返回x

思路2：

递归思想，循环字符串，

找到最后一个#，截取左右两边的字符串，作为递归参数，利用`2*{x}+3*{y}+4`

找到最后一个$，截取左右两边的字符串，作为递归参数，利用`3*{x}+{y}+2`

最返回数据即可

```python
class Martion(object):
    def func2(self, nums: str) -> int:
        # 无符号数
        index_list = [i for i, c in enumerate(nums) if c in "#$"]

        # 按操作符 分隔字符串
        stack = []
        s = 0
        for e in index_list:
            stack.append(int(nums[s:e]))
            stack.append(nums[e])
            s = e + 1
        else:
            stack.append(int(nums[s:]))
        # 计算 优先级高的$ f"3*{x}+{y}+2")
        r_stack = []
        while stack:
            item = stack.pop()
            if item == "$":
                x = stack.pop()
                y = r_stack.pop()
                stack.append(eval(f"3*{x}+{y}+2"))
            else:
                r_stack.append(item)
        stack += r_stack[::-1]

        # 计算 2*{x}+3*{y}+4"
        x = stack[0]
        for i in range(2, len(stack), 2):
            y = stack[i]
            x = eval(f"2*{x}+3*{y}+4")
        return x

    def func(self, nums: str) -> int:
        '''x#y = 2x+3y+4
    x$y = 3*x+y+2
    $的优先级高于#'''

        def func3(nums: str) -> int:
            idx = nums.rfind("#")
            if idx != -1:
                left = nums[0:idx]
                right = nums[idx + 1:]
                return 2 * func3(left) + 3 * func3(right) + 4
            idx = nums.rfind("$")
            if idx != -1:
                left = nums[0:idx]
                right = nums[idx + 1:]
                return 3 * func3(left) + func3(right) + 2
            return int(nums)

        return func3(nums)


while 1:
    try:
        nums = input()
        m = Martion()
        print(m.func(nums))
    except Exception as e:
        break
```



```java
package com.tom.huawei;

import lombok.extern.slf4j.Slf4j;

import java.util.List;
import java.util.Scanner;
import java.util.Stack;
import java.util.stream.Collectors;
import java.util.stream.IntStream;

@Slf4j
public class Martion {
    public static void main(String[] args) {
        Martion m = new Martion();
        Scanner sc = new Scanner(System.in);
        while (sc.hasNext()) {
            String input = sc.nextLine();
            System.out.println(m.func(input));
        }
        sc.close();
    }

    public int func(String input) {
        //优先算最后#
        int index = input.lastIndexOf("#");
        if (index != -1) {
            String left = input.substring(0, index);
            String right = input.substring(index + 1);
            int res = 2 * func(left) + 3 * func(right) + 4;
            return res;
        }
        //优先算第一$
        index = input.lastIndexOf("$");
        if (index != -1) {
            String left = input.substring(0, index);
            String right = input.substring(index + 1);
            int res = 3 * func(left) + func(right) + 2;
            return res;
        }
        return Integer.parseInt(input);
    }

    public int fun2(String input) {
        // 无符号数
        List<Integer> idxList = IntStream.range(1, input.length()).filter(i -> input.charAt(i) == '#' || input.charAt(i) == '$').boxed().collect(Collectors.toList());
        // 按操作符 分隔字符串
        Stack stack = new Stack();
        int s = 0;
        for (int e : idxList) {
            stack.push(Integer.parseInt(input.substring(s, e)));
            stack.push(input.charAt(e));
            s = e + 1;
        }
        stack.push(Integer.parseInt(input.substring(s)));
        // 计算 优先级高的$ f"3*{x}+{y}+2")
        Stack r_stack = new Stack();
        while (!stack.isEmpty()) {
            String item = stack.pop().toString();
            if (item.charAt(0) == '$') {
                int x = Integer.parseInt(stack.pop().toString());
                int y = Integer.parseInt(r_stack.pop().toString());
                stack.push(3 * x + y + 2);
            } else {
                r_stack.push(item);
            }
        }
        stack = r_stack;
        // 计算 2*{x}+3*{y}+4"
        int x = Integer.parseInt(stack.pop().toString());
        while (!stack.isEmpty()) {
            stack.pop();
            int y = Integer.parseInt(stack.pop().toString());
            x = 2 * x + 3 * y + 4;
        }
        return x;
    }
}
```

